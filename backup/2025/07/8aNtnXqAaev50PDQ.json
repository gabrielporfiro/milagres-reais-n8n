{
  "active": true,
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Salva no banco de dados o numero",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CAMINHO 2 ‚Äì ORA√á√ÉO PERSONALIZADA": {
      "main": [
        [
          {
            "node": "Etapa:4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CAMINHO 4 ‚Äì TESTEMUNHO": {
      "main": [
        [
          {
            "node": "Etapa:2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Verifica etapa": {
      "main": [
        [
          {
            "node": "Mensagem de apresenta√ß√£o",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ETAPA 1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Verifica subetapa",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Escolha Valor",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Verifica subetapa2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Escolha Valor1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ETAPA 1": {
      "main": [
        [
          {
            "node": "CAMINHO 4 ‚Äì TESTEMUNHO",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CAMINHO 3 ‚Äì PALAVRA DO DIA",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CAMINHO 2 ‚Äì ORA√á√ÉO PERSONALIZADA",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Verifica a quantidade gerado",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CAMINHO 1 ‚Äì QUERO SER UM ANJO",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "OP√á√ÉO INVALIDA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Inserir nome de quem vai testemunhar": {
      "main": [
        [
          {
            "node": "CAMINHO 4.1 -",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CAMINHO 4.1 -": {
      "main": [
        [
          {
            "node": "Subetapa: 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CAMINHO 4.2": {
      "main": [
        [
          {
            "node": "Subetapa: 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Verifica subetapa": {
      "main": [
        [
          {
            "node": "Inserir nome de quem vai testemunhar",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Tipo da resposta",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Privacidade selecionada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Salva no banco de dados o numero": {
      "main": [
        [
          {
            "node": "Verificar palavra chave \"VOLTAR PARA O MENU\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza o testemunho": {
      "main": [
        [
          {
            "node": "CAMINHO 4.2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Privacidade selecionada": {
      "main": [
        [
          {
            "node": "Atualiza a privacidade [True]",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Atualiza a privacidade [False]",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "PRIVACIDADE INVALIDA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza a privacidade [True]": {
      "main": [
        [
          {
            "node": "CAMINHO 4.3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CAMINHO 4.3": {
      "main": [
        [
          {
            "node": "Volta pro menu inicial",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Tipo da resposta": {
      "main": [
        [
          {
            "node": "Atualiza o testemunho",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Baixando audio",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "FORMATO INVALIDO",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza a privacidade [False]": {
      "main": [
        [
          {
            "node": "CAMINHO 4.3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CAMINHO 3 ‚Äì PALAVRA DO DIA": {
      "main": [
        [
          {
            "node": "Etapa:3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensagem de apresenta√ß√£o": {
      "main": [
        [
          {
            "node": "Atualiza a etapa",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gerar uma mensagem socorro": {
      "main": [
        [
          {
            "node": "Resposta Socorro",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resposta Socorro": {
      "main": [
        [
          {
            "node": "Salvar prompt gerado",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Verifica a quantidade gerado": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Gerar uma mensagem socorro",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Limite Socorro",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Baixando audio": {
      "main": [
        [
          {
            "node": "Transcrever depoimento",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limite Socorro": {
      "main": [
        [
          {
            "node": "Volta pro menu inicial1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Salvar prompt gerado": {
      "main": [
        [
          {
            "node": "Volta pro menu inicial1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Verifica subetapa2": {
      "main": [
        [
          {
            "node": "Verifica para quem destina",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "[Propria] Nome do usuario",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "[Propria]Tipo da resposta",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "[Compartilhada] Nome do presenteado",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "[Compartilhada] Nome de quem enviou",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "[Compartilhada]Tipo da resposta1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Verifica para quem destina": {
      "main": [
        [
          {
            "node": "[Propria] Definindo nome",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "[Compartilhada] Definindo nome presenteado",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "OPCAO DE ORACAO INVALIDA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[Propria] Nome do usuario": {
      "main": [
        [
          {
            "node": "[Propria] Solicita o pedido",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[Propria] Solicita o pedido": {
      "main": [
        [
          {
            "node": "Atualiza a subetapa:4.3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Baixando audio1": {
      "main": [
        [
          {
            "node": "Transcribe a recording1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transcribe a recording1": {
      "main": [
        [
          {
            "node": "Atualiza ora√ß√£o1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza ora√ß√£o": {
      "main": [
        [
          {
            "node": "CAMINHO 4.4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza ora√ß√£o1": {
      "main": [
        [
          {
            "node": "CAMINHO 4.4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CAMINHO 4.4": {
      "main": [
        [
          {
            "node": "Volta pro menu inicial2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[Propria]Tipo da resposta": {
      "main": [
        [
          {
            "node": "Atualiza ora√ß√£o",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Baixando audio1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "FORMATO INVALIDO1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[Compartilhada] Nome do presenteado": {
      "main": [
        [
          {
            "node": "[Compartilhada] Solicita quem esta enviando",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[Compartilhada] Nome de quem enviou": {
      "main": [
        [
          {
            "node": "[Compartilhada] Solicita o pedido",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[Compartilhada] Solicita quem esta enviando": {
      "main": [
        [
          {
            "node": "Atualiza a subetapa:4.5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[Compartilhada] Solicita o pedido": {
      "main": [
        [
          {
            "node": "Atualiza a subetapa:4.6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza ora√ß√£o2": {
      "main": [
        [
          {
            "node": "CAMINHO 4.",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transcribe a recording2": {
      "main": [
        [
          {
            "node": "Atualiza ora√ß√£o3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Baixando audio2": {
      "main": [
        [
          {
            "node": "Transcribe a recording2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza ora√ß√£o3": {
      "main": [
        [
          {
            "node": "CAMINHO 4.",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[Compartilhada]Tipo da resposta1": {
      "main": [
        [
          {
            "node": "Atualiza ora√ß√£o2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Baixando audio2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "FORMATO INVALIDO2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza a subetapa:4.6": {
      "main": [
        []
      ]
    },
    "CAMINHO 4.": {
      "main": [
        [
          {
            "node": "Volta pro menu inicial2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Escolha Valor": {
      "main": [
        [
          {
            "node": "Quantas palavras do dia foram geradas",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "R$5,99",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "R$9,99",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "R$19,99",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ESCOLHA DE OP√á√ÉO INVALIDA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "R$5,99": {
      "main": [
        [
          {
            "node": "Mensagem - Link de Pagamento",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "R$9,99": {
      "main": [
        [
          {
            "node": "Mensagem - Link de Pagamento",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "R$19,99": {
      "main": [
        [
          {
            "node": "Mensagem - Link de Pagamento",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensagem Gratuito": {
      "main": [
        [
          {
            "node": "Salvar prompt gerado da palavra",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Volta pro menu inicial4": {
      "main": [
        [
          {
            "node": "Mensagem de apresenta√ß√£o",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CAMINHO 1 ‚Äì QUERO SER UM ANJO": {
      "main": [
        [
          {
            "node": "Etapa:5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza o depoimento do testemunho": {
      "main": [
        [
          {
            "node": "CAMINHO 4.2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transcrever depoimento": {
      "main": [
        [
          {
            "node": "Atualiza o depoimento do testemunho",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Verificar palavra chave \"VOLTAR PARA O MENU\"": {
      "main": [
        [
          {
            "node": "Volta pro menu inicial4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Verifica etapa",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Escolha Valor1": {
      "main": [
        [
          {
            "node": "1Ô∏è‚É£ R$1,99 ‚Äì Semente leve  ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "2Ô∏è‚É£ R$3,99 ‚Äì Pequeno Milagre ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "3Ô∏è‚É£ R$7,99 ‚Äì F√© ativa ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "4Ô∏è‚É£ R$14,99 ‚Äì Apoio com prop√≥sito  ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "5Ô∏è‚É£ R$29,99 ‚Äì Anjo de Esperan√ßa",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "6Ô∏è‚É£ R$49,99 ‚Äì Anjo Vision√°rio",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ESCOLHA DE OP√á√ÉO INVALIDA1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensagem Gratuito1": {
      "main": [
        [
          {
            "node": "Volta pro menu inicial5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1Ô∏è‚É£ R$1,99 ‚Äì Semente leve  ": {
      "main": [
        [
          {
            "node": "Mensagem Gratuito1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "2Ô∏è‚É£ R$3,99 ‚Äì Pequeno Milagre ": {
      "main": [
        [
          {
            "node": "Mensagem Gratuito1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "3Ô∏è‚É£ R$7,99 ‚Äì F√© ativa ": {
      "main": [
        [
          {
            "node": "Mensagem Gratuito1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "4Ô∏è‚É£ R$14,99 ‚Äì Apoio com prop√≥sito  ": {
      "main": [
        [
          {
            "node": "Mensagem Gratuito1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "5Ô∏è‚É£ R$29,99 ‚Äì Anjo de Esperan√ßa": {
      "main": [
        [
          {
            "node": "Mensagem Gratuito1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "6Ô∏è‚É£ R$49,99 ‚Äì Anjo Vision√°rio": {
      "main": [
        [
          {
            "node": "Mensagem Gratuito1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Quantas palavras do dia foram geradas": {
      "main": [
        [
          {
            "node": "Olhar quantidade m√°xima gerada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Olhar quantidade m√°xima gerada": {
      "main": [
        [
          {
            "node": "Gerar uma mensagem da palavra do dia",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mensagem Gratuito2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensagem Gratuito2": {
      "main": [
        [
          {
            "node": "Volta pro menu inicial3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Salvar prompt gerado da palavra": {
      "main": [
        [
          {
            "node": "Volta pro menu inicial3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gerar uma mensagem da palavra do dia": {
      "main": [
        [
          {
            "node": "Mensagem Gratuito",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[Propria] Definindo nome": {
      "main": [
        [
          {
            "node": "Atualiza a subetapa:4.2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "[Compartilhada] Definindo nome presenteado": {
      "main": [
        [
          {
            "node": "Atualiza a subetapa:4.4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensagem - Link de Pagamento": {
      "main": [
        [
          {
            "node": "Volta pro menu inicial3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-07-22T20:31:05.087Z",
  "id": "8aNtnXqAaev50PDQ",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Fluxo Whatsapp",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "2d913d19-cbbc-4762-b247-ce3342476e67",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -2416,
        960
      ],
      "id": "0285ca04-de0b-4aed-9dad-624fadb489ad",
      "name": "Webhook",
      "webhookId": "2d913d19-cbbc-4762-b247-ce3342476e67"
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "Escolha:\n1Ô∏è‚É£ Quero uma ora√ß√£o para mim  \n2Ô∏è‚É£ Quero dar uma ora√ß√£o de presente\n",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -336,
        368
      ],
      "id": "a785a19d-cc45-4af1-b033-6f1ee485b2ec",
      "name": "CAMINHO 2 ‚Äì ORA√á√ÉO PERSONALIZADA",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "üå§ Palavra do Dia enviada!\n\nEscolha sua contribui√ß√£o (opcional):\n1Ô∏è‚É£ Gratuito  \n2Ô∏è‚É£ R$5,99 ‚Äì Semente de f√©  \n3Ô∏è‚É£ R$9,99 ‚Äì Ora√ß√£o com prop√≥sito  \n4Ô∏è‚É£ R$19,99 ‚Äì Milagre em forma de ora√ß√£o  ",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -336,
        192
      ],
      "id": "6b591325-2192-47f2-88e1-9731dfa9ad85",
      "name": "CAMINHO 3 ‚Äì PALAVRA DO DIA",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "üôè Que alegria saber que voc√™ viveu um milagre!\n\nEnvie:\n1. Seu nome completo (ou fict√≠cio)",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -336,
        0
      ],
      "id": "c616f0ae-7b19-4160-9c5a-9e279f5f4c2e",
      "name": "CAMINHO 4 ‚Äì TESTEMUNHO",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "üòá Acho que voc√™ digitou algo que n√£o est√° na lista.\n\nMas n√£o tem problema! Deus nos ensina a tentar de novo com amor.\n\nEscolha uma das op√ß√µes abaixo, digitando apenas o n√∫mero:\n\n1Ô∏è‚É£ Enviar um Testemunho  \n2Ô∏è‚É£ Palavra do Dia  \n3Ô∏è‚É£ Ora√ß√£o Personalizada  \n4Ô∏è‚É£ Socorro (urgente)  \n5Ô∏è‚É£ ‚ú® Quero¬†ser¬†um¬†Anjo¬†‚ú®",
        "additionalFields": {
          "delayTyping": 2
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -720,
        736
      ],
      "id": "602152fb-228f-43a8-b39a-a4efe028f487",
      "name": "OP√á√ÉO INVALIDA",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.current_step.toString() }}",
                    "rightValue": "0",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "4186a014-12d7-44f4-b588-2bc4f7983104"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d0caa72a-04ad-4fcc-a556-85b87084b6e9",
                    "leftValue": "={{ $json.current_step.toString() }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "784d77b0-fe0b-4228-ada4-343a6676bada",
                    "leftValue": "={{ $json.current_step.toString() }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d6e99a7b-06fb-4ba0-8362-4b860390f80b",
                    "leftValue": "={{ $json.current_step.toString() }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "869604b5-6e97-4ffc-9319-c192a938a03b",
                    "leftValue": "={{ $json.current_step.toString() }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "c2f63479-e6af-4585-9097-c8ddb8d2ecbc",
                    "leftValue": "={{ $json.current_step.toString() }}",
                    "rightValue": "5",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -1728,
        928
      ],
      "id": "dcf5bfba-91c7-41e4-978b-25f3049db0c7",
      "name": "Verifica etapa"
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "current_step": 1,
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "sub_step": 0,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -544,
        -288
      ],
      "id": "d2bd17e1-d0eb-435f-a5d8-6b327850634e",
      "name": "Atualiza a etapa",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "872a1a59-7b3f-443c-9a89-3f8951aeb14c",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "1¬∫ OP√á√ÉO"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "92879e7a-4ad6-4df9-a116-f990fbb18088",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "2¬∫ OP√á√ÉO"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "6d7c1b77-e7f8-4be3-9bca-559511bfc615",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "3¬∫ OP√á√ÉO"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "6991be18-8030-42d2-868f-b8105f11eb47",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "4¬∫ OP√á√ÉO"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "9e8f03e2-b4d1-4278-b602-6844ddb975ac",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "5",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "5¬∫ OP√á√ÉO"
            }
          ]
        },
        "looseTypeValidation": true,
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -768,
        320
      ],
      "id": "14379392-89d0-4b06-9f84-e8cbe5a4c96e",
      "name": "ETAPA 1"
    },
    {
      "parameters": {
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "testemunhos",
          "mode": "list",
          "cachedResultName": "testemunhos"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "nome": "={{ $('Webhook').item.json.body.text.message }}",
            "number": "={{ $('Webhook').item.json.body.phone }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome",
              "displayName": "nome",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "depoimento",
              "displayName": "depoimento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -336,
        1008
      ],
      "id": "2764353d-6402-4044-868a-10b3e770aeb2",
      "name": "Inserir nome de quem vai testemunhar",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "2. Me conte agora seu milagre! (Fique √† vontade para enviar seu testemunho em √°udio ou texto.)",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -112,
        1008
      ],
      "id": "a15d807a-8253-479e-880d-78f098ca20c9",
      "name": "CAMINHO 4.1 -",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "Voc√™ autoriza o compartilhamento?\n1Ô∏è‚É£ AUTORIZO ‚Äì para permitir o compartilhamento\n2Ô∏è‚É£ N√ÉO AUTORIZO\n",
        "additionalFields": {
          "delayTyping": 2
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        480,
        1248
      ],
      "id": "dbfc050c-44c7-4ac3-86f3-77cac47885f9",
      "name": "CAMINHO 4.2",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "content": "## ‚úÖ CAMINHO 4 ‚Äì TESTEMUNHO - FLUXO AP√ìS ESCOLHA",
        "height": 1296,
        "width": 1632,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -800,
        960
      ],
      "id": "b281fbb2-20b7-41a4-bca6-9825d49e6142",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d0caa72a-04ad-4fcc-a556-85b87084b6e9",
                    "leftValue": "={{ $json.sub_step.toString() }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "1"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "784d77b0-fe0b-4228-ada4-343a6676bada",
                    "leftValue": "={{ $json.sub_step.toString() }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "2"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "acdbd02d-8d10-40f7-8fd0-ef6fb0dce63b",
                    "leftValue": "={{ $json.sub_step.toString() }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "3"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -768,
        1040
      ],
      "id": "f88a4461-a467-48d5-aaae-fe3b81c5f037",
      "name": "Verifica subetapa"
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "current_step": 0,
            "sub_step": 0,
            "phone_number": "={{ $json.phone_number }}"
          },
          "matchingColumns": [
            "phone_number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        304,
        1808
      ],
      "id": "8173b1c9-8c3f-4e83-b0af-e0edf3075546",
      "name": "Volta pro menu inicial",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "upsert",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "flow_name": "whatsapp",
            "phone_number": "={{ $json.body.phone }}"
          },
          "matchingColumns": [
            "phone_number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": false
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": false,
              "removed": true
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": false,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": false,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": false,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -2208,
        960
      ],
      "id": "15c7083b-fbe6-46c1-901d-191e74fbe5d6",
      "name": "Salva no banco de dados o numero",
      "notesInFlow": false,
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      },
      "notes": "teste"
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "testemunhos",
          "mode": "list",
          "cachedResultName": "testemunhos"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "number": "={{ $json.phone_number }}",
            "depoimento": "={{ $('Webhook').item.json.body.text.message }}"
          },
          "matchingColumns": [
            "number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome",
              "displayName": "nome",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "depoimento",
              "displayName": "depoimento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -112,
        1184
      ],
      "id": "8ee64f89-eed0-43b2-a59a-ca341d0a6544",
      "name": "Atualiza o testemunho",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "Ops! üôè\nPara compartilhar seu testemunho, envie:\n- Um √°udio de 3 a 5 minutos üé§\nou\n-  Um texto de 300 a 600 palavras üí¨",
        "editMessageId": "=",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -112,
        1520
      ],
      "id": "7a13af7a-48d5-47ac-8cbb-307140cebd5c",
      "name": "FORMATO INVALIDO",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "63adc694-5888-47cf-a09b-3c5d53e76eb2"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "permitido"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e89b1c90-91c3-47e9-8854-0827a43f3ded",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "nao_permitido"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -336,
        1856
      ],
      "id": "71c33f3f-1322-4711-934b-f2ba08fb470a",
      "name": "Privacidade selecionada"
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "value": "public",
          "mode": "list",
          "cachedResultName": "public"
        },
        "table": {
          "__rl": true,
          "value": "testemunhos",
          "mode": "list",
          "cachedResultName": "testemunhos"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "privacidade": true,
            "number": "={{ $json.phone_number }}"
          },
          "matchingColumns": [
            "number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome",
              "displayName": "nome",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "depoimento",
              "displayName": "depoimento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "privacidade",
              "displayName": "privacidade",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -96,
        1728
      ],
      "id": "ad491275-b94a-43ee-b371-bc53bf6287cd",
      "name": "Atualiza a privacidade [True]",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "Sua hist√≥ria ser√° tratada com respeito e amor.\nEla j√° √© semente. Obrigado por compartilhar!",
        "additionalFields": {
          "delayTyping": 2
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        128,
        1808
      ],
      "id": "262c060e-7069-405a-94c1-21449b501889",
      "name": "CAMINHO 4.3",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "Sua hist√≥ria ser√° tratada com respeito e amor.\nEla j√° √© semente. Obrigado por compartilhar!",
        "additionalFields": {
          "delayTyping": 1
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -96,
        2080
      ],
      "id": "c2ae8126-23e5-4894-ac17-309ec15a415b",
      "name": "PRIVACIDADE INVALIDA",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Webhook').item.json.body.text }}",
                    "rightValue": "",
                    "operator": {
                      "type": "object",
                      "operation": "exists",
                      "singleValue": true
                    },
                    "id": "63adc694-5888-47cf-a09b-3c5d53e76eb2"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "texto"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e89b1c90-91c3-47e9-8854-0827a43f3ded",
                    "leftValue": "={{ $('Webhook').item.json.body.audio }}",
                    "rightValue": "",
                    "operator": {
                      "type": "object",
                      "operation": "exists",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "audio"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -336,
        1312
      ],
      "id": "5313e001-4598-4e0b-adb7-269c1b05410b",
      "name": "Tipo da resposta"
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "value": "public",
          "mode": "list",
          "cachedResultName": "public"
        },
        "table": {
          "__rl": true,
          "value": "testemunhos",
          "mode": "list",
          "cachedResultName": "testemunhos"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "privacidade": false,
            "number": "={{ $json.phone_number }}"
          },
          "matchingColumns": [
            "number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome",
              "displayName": "nome",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "depoimento",
              "displayName": "depoimento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "privacidade",
              "displayName": "privacidade",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -96,
        1920
      ],
      "id": "edf6caa4-5d56-4e58-a8a7-a3856e96355c",
      "name": "Atualiza a privacidade [False]",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "content": "## üìã MENU",
        "height": 928,
        "width": 1824
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -800,
        -16
      ],
      "id": "f4620b05-dbd0-4b1d-bccb-bc0d8a1c8a0e",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## üåü BOAS VINDAS",
        "height": 304,
        "width": 1520,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -800,
        -368
      ],
      "id": "7d179970-d33f-44fb-8f17-b6334474b2d8",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "üì≤ Ol√°, seja bem-vindo ao üåø Milagres Reais.\nAqui, milagres n√£o s√£o hist√≥rias. S√£o verdades.\n\n‚ù§ Me diga com o cora√ß√£o: como posso te ajudar hoje?\n\nEscolha uma das op√ß√µes abaixo digitando apenas o n√∫mero:\n\n1Ô∏è‚É£ Contar meu milagre\n2Ô∏è‚É£ Receber a Palavra do Dia\n3Ô∏è‚É£ Receber uma Ora√ß√£o feita s√≥ pra voc√™ (em √°udio)\n4Ô∏è‚É£ Pedir Socorro (Urgente)\n5Ô∏è‚É£ ‚ú® Quero ser um Anjo ‚ú®\n\nüéß Quer ouvir testemunhos reais que transformam vidas?\nüëâ Acesse agora: https://spotify.milagresreais.com.br",
        "additionalFields": {
          "delayTyping": 5
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -768,
        -288
      ],
      "id": "6509d221-dfeb-4788-b727-bb0b43ade1b9",
      "name": "Mensagem de apresenta√ß√£o",
      "notesInFlow": false,
      "alwaysOutputData": false,
      "executeOnce": false,
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "content": "## ‚úÖ CAMINHO 2 ‚Äì ORA√á√ÉO PERSONALIZADA",
        "height": 2256,
        "width": 1632,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -800,
        3472
      ],
      "id": "68c24558-aeeb-4bd6-b787-dd043ba3e9fc",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d0caa72a-04ad-4fcc-a556-85b87084b6e9",
                    "leftValue": "={{ $json.sub_step.toString() }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "1"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "784d77b0-fe0b-4228-ada4-343a6676bada",
                    "leftValue": "={{ $json.sub_step.toString() }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "2"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5878dc59-1826-4f8c-95b9-7f5acc882a10",
                    "leftValue": "={{ $json.sub_step.toString() }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "3"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "b0ee25ec-220c-42f7-a731-d860a50bb64c",
                    "leftValue": "={{ $json.sub_step.toString() }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "4"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "fae9143e-3393-4d83-a407-5ae7781950e5",
                    "leftValue": "={{ $json.sub_step.toString() }}",
                    "rightValue": "5",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "5"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "4b470ed8-b080-4845-a741-2ffe82a76d05",
                    "leftValue": "={{ $json.sub_step.toString() }}",
                    "rightValue": "6",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "6"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -752,
        4160
      ],
      "id": "8b7298f9-626b-4cde-ae67-c23baca27e79",
      "name": "Verifica subetapa2"
    },
    {
      "parameters": {
        "model": "openai/gpt-5-chat",
        "message": "Prompt -Voc√™ √© a voz oficial do projeto Milagres Reais. Responda a algu√©m que apertou o ‚ÄúBot√£o de Socorro‚Äù pedindo calma e f√©. Crie uma mensagem curta, de at√© 100 palavras, com tom acolhedor e esperan√ßoso, como um amigo que segura a m√£o no momento dif√≠cil. Cada resposta deve ser √∫nica, evitando repeti√ß√µes de frases e usando diferentes imagens, met√°foras e formas de consolar. Inclua uma breve ora√ß√£o que transmita paz e encorajamento. Termine sempre refor√ßando que a pessoa n√£o est√° sozinha e que Deus est√° cuidando de cada detalhe, mesmo quando ela n√£o consegue perceber.\nEscolha de forma aleat√≥ria sempre um dos seguintes in√≠cios para a mensagem(entre 1 a 7) abaixo:\n1-\"Sinta Deus falando com voc√™:\"\n2-\"Creio que esta palavra √© resposta para o seu clamor:\"\n3-\"Deus me colocou no seu caminho para dizer:\"\n4-\"No meio dessa dor, Deus quer que voc√™ saiba:\"\n5-\"Deixe esta palavra alcan√ßar sua alma:\"\n6-\"Talvez seja tudo o que voc√™ precisa ouvir hoje:\"\n7-\"Guarde bem esta mensagem no seu cora√ß√£o:\"\nNa sua resposta deve retornar somente o titulo em negrito e italico\ne o restante da frase de socorro traga na linha abaixo\nFinalize todas as mensagens com o seguinte texto:\nQue Deus aben√ßoe e multiplique a sua semente de amor.\n‚ú® E se desejar, torne-se um Anjo do Projeto Milagres Reais, ajudando a levar consolo e f√© para quem mais precisa.\nExemplo 1:\nSinta Deus falando com voc√™:\"\n\"Eu sei que parece imposs√≠vel agora, mas respire: nada foge das m√£os de Deus. Ele j√° est√° no seu amanh√£, preparando o que hoje parece distante. Senhor, derrama paz sobre este cora√ß√£o e firme os passos nesta hora. Voc√™ n√£o est√° sozinho(a).\"\nExemplo 2:\n\"Creio que esta palavra √© resposta para o seu clamor:\"\n\"Quando as ondas ficam altas, lembre-se: Jesus ainda est√° no barco. Ele n√£o abandonou voc√™. Senhor, acalma este cora√ß√£o, traga serenidade e mostre que a noite n√£o √© eterna. Voc√™ n√£o est√° sozinho(a).\"\nExemplo 3:\n\"Deixe esta palavra alcan√ßar sua alma:\"\n\"O peso que voc√™ sente hoje n√£o √© o fim da hist√≥ria. Deus conhece cada l√°grima e est√° trabalhando nelas. Senhor, envolve este cora√ß√£o com amor e esperan√ßa nova. Voc√™ n√£o est√° sozinho(a).\"",
        "temperature": 0.5,
        "additionalFields": {}
      },
      "type": "n8n-nodes-openrouter.openRouter",
      "typeVersion": 1,
      "position": [
        128,
        496
      ],
      "id": "106d4538-5c44-41cf-8b3e-09e9bf02b416",
      "name": "Gerar uma mensagem socorro",
      "credentials": {
        "openRouterApi": {
          "id": "XLUNvFV9dYDqE6Ci",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 0,
            "sub_step": 0,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        768,
        592
      ],
      "id": "cc8bd55c-89cb-495e-897f-d80d21bab4a5",
      "name": "Volta pro menu inicial1",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "={{ $json.response }}",
        "additionalFields": {
          "delayTyping": 2
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        320,
        496
      ],
      "id": "fbf525f3-8bc5-48c4-8dc2-405c387fba80",
      "name": "Resposta Socorro",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT COUNT(id)\nFROM public.whatsapp_oracoes_geradas w \nwhere w.number = '{{ $('Webhook').item.json.body.phone }}'\nand w.data = '{{$now.toFormat('yyyy-MM-dd')}}';",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -336,
        560
      ],
      "id": "203cc902-4ee8-438f-ba12-0b79e9efdf8c",
      "name": "Verifica a quantidade gerado",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "029e0f97-3593-48ad-af41-b2f2681a3d28",
              "leftValue": "={{ $json.count }}",
              "rightValue": 3,
              "operator": {
                "type": "number",
                "operation": "lte"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {
          "ignoreCase": false
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -96,
        576
      ],
      "id": "5102a37a-cc9d-4243-bfc8-21f69f11b5c2",
      "name": "If"
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "üôè Lamentamos que, mesmo com todas as mensagens j√° enviadas, voc√™ ainda n√£o esteja se sentindo bem.\nQueremos continuar ao seu lado, fortalecendo sua f√© e trazendo novas palavras de esperan√ßa.\n\nüìå Voc√™ tamb√©m pode gerar uma ora√ß√£o personalizada para o seu caso atrav√©s do menu, na op√ß√£o 3.\nüíõ Sua contribui√ß√£o mant√©m este projeto vivo e leva esperan√ßa a muitas outras vidas.\nhttps://doacao.milagresreais.com.br\n\nQue Deus aben√ßoe e multiplique a sua semente de amor.\n‚ú® E se desejar, torne-se um Anjo do Projeto Milagres Reais, ajudando a levar consolo e f√© para quem mais precisa.",
        "additionalFields": {
          "delayTyping": 2
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        128,
        688
      ],
      "id": "171510eb-ef77-426f-b7e8-92becd41dfc1",
      "name": "Limite Socorro",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "url": "={{ $('Webhook').item.json.body.audio.audioUrl }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -112,
        1376
      ],
      "id": "b4ad2629-db88-493e-a41c-3dd0d5c36e37",
      "name": "Baixando audio"
    },
    {
      "parameters": {
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_oracoes_geradas",
          "mode": "list",
          "cachedResultName": "whatsapp_oracoes_geradas"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "data": "={{$now.toFormat('yyyy-MM-dd')}}",
            "oracao": "={{ $('Gerar uma mensagem socorro').item.json.response }}",
            "number": "={{ $('Salva no banco de dados o numero').item.json.phone_number }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "oracao",
              "displayName": "oracao",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "data",
              "displayName": "data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        512,
        496
      ],
      "id": "67e20c6f-582f-4db8-9ea2-8024efbff69c",
      "name": "Salvar prompt gerado",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 4,
            "sub_step": 2,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -16,
        3552
      ],
      "id": "fd943795-81c5-442b-885e-43d0ecadbd6a",
      "name": "Atualiza a subetapa:4.2",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d0caa72a-04ad-4fcc-a556-85b87084b6e9",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "1"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "784d77b0-fe0b-4228-ada4-343a6676bada",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "2"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -464,
        3632
      ],
      "id": "8fc70d8d-203b-4a9d-8d97-5c5237fcfb02",
      "name": "Verifica para quem destina"
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "Ops! N√£o entendi sua escolha. üôè\nEscolha uma das op√ß√µes abaixo para continuarmos sua ora√ß√£o:\n\n1Ô∏è‚É£ Quero uma ora√ß√£o para mim ‚ú®\n2Ô∏è‚É£ Quero dar uma ora√ß√£o de presente üéÅ\n\nSua f√© merece seguir pelo caminho certo para ser aben√ßoada.",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -208,
        3888
      ],
      "id": "b63a0ec3-a1fc-47dc-a589-dfd0c26dc0ab",
      "name": "OPCAO DE ORACAO INVALIDA",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_oracoes_personalizadas",
          "mode": "list",
          "cachedResultName": "whatsapp_oracoes_personalizadas"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "number": "={{ $('Webhook').item.json.body.phone }}",
            "tipo": "propria",
            "nome_usuario": "={{ $('Webhook').item.json.body.text.message }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "tipo",
              "displayName": "tipo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "nome_usuario",
              "displayName": "nome_usuario",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "nome_partilhada",
              "displayName": "nome_partilhada",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "pedido",
              "displayName": "pedido",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "gerado",
              "displayName": "gerado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -448,
        4096
      ],
      "id": "2810cbf8-ae36-4fe1-801e-b81e3b6b33c5",
      "name": "[Propria] Nome do usuario",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "- Pedido de ora√ß√£o (texto ou √°udio)",
        "additionalFields": {
          "delayTyping": 2
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -208,
        4096
      ],
      "id": "93a2ec52-547d-444b-8fef-44b048cc9342",
      "name": "[Propria] Solicita o pedido",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 4,
            "sub_step": 4,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -16,
        3712
      ],
      "id": "ecb9c1ae-5a15-4aaa-bb41-98996b58060e",
      "name": "Atualiza a subetapa:4.4",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 4,
            "attempts": 0,
            "sub_step": 3
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        32,
        4096
      ],
      "id": "82cc935b-59f7-45d6-8a4c-50c68b38904c",
      "name": "Atualiza a subetapa:4.3",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_oracoes_personalizadas",
          "mode": "list",
          "cachedResultName": "whatsapp_oracoes_personalizadas"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "number": "={{ $json.phone_number }}",
            "pedido": "={{ $('Webhook').item.json.body.text.message }}"
          },
          "matchingColumns": [
            "number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "tipo",
              "displayName": "tipo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_usuario",
              "displayName": "nome_usuario",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_partilhada",
              "displayName": "nome_partilhada",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "pedido",
              "displayName": "pedido",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "gerado",
              "displayName": "gerado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -240,
        4288
      ],
      "id": "e431f11f-05c6-449b-b747-60505ca5114c",
      "name": "Atualiza ora√ß√£o",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -64,
        4416
      ],
      "id": "36c9b8c4-0272-43d7-a4be-bbb10121c1ba",
      "name": "Transcribe a recording1",
      "credentials": {
        "openAiApi": {
          "id": "nrLX2LxKR5fSsuxx",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "url": "={{ $('Webhook').item.json.body.audio.audioUrl }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -240,
        4416
      ],
      "id": "f39a20e9-1bc3-40d2-a849-945259a73aa7",
      "name": "Baixando audio1"
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "Ops! üôè\nPara fazer seu pedido, envie:\n- Um √°udio de 3 a 5 minutos üé§\nou\n-  Um texto de 300 a 600 palavras üí¨",
        "editMessageId": "=",
        "additionalFields": {
          "delayTyping": 2
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -240,
        4576
      ],
      "id": "a81359e0-5855-437a-a21b-8e2fec98768a",
      "name": "FORMATO INVALIDO1",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_oracoes_personalizadas",
          "mode": "list",
          "cachedResultName": "whatsapp_oracoes_personalizadas"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "number": "={{ $json.phone_number }}",
            "pedido": "={{ $('Webhook').item.json.body.text.message }}"
          },
          "matchingColumns": [
            "number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "tipo",
              "displayName": "tipo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_usuario",
              "displayName": "nome_usuario",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_partilhada",
              "displayName": "nome_partilhada",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "pedido",
              "displayName": "pedido",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "gerado",
              "displayName": "gerado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        112,
        4416
      ],
      "id": "b5273407-0e78-4bdd-9760-34127ce4f5a0",
      "name": "Atualiza ora√ß√£o1",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "Falta muito pouco para voc√™ receber sua ora√ß√£o. Escolha agora o valor da sua doa√ß√£o, clique no link e finalize seu pedido.\n\nüí≥ Doa√ß√µes: \n- R$ 5,99 \n‚Äì Semente de f√© üå± \n- R$ 9,99 \n‚Äì Ora√ß√£o com prop√≥sito üïä \n- R$ 19,99 ‚Äì Milagre em forma de ora√ß√£o üí´ \n- Valor livre ‚Äî ‚ÄúMinha f√© ajuda outras pessoas‚Äù üíõ \n- Gr√°tis enquanto dispon√≠vel üìù \n\nBackup PIX: milagre@passe.com.br \nüé• Entrega: V√≠deo com voz do autor (Reginaldo Uller) Imagem simb√≥lica com legenda Vers√≠culo b√≠blico Trilha suave Legenda storytelling Dura√ß√£o: 100 a 150 segundos Formato: Shorts, Reels, WhatsApp, TikTok etc Qualidade e formato que atenda os aplicativos \n‚è∞ Ap√≥s 24h: ‚ÄúComo voc√™ est√° desde a √∫ltima vez que falamos? Posso orar por algo novo hoje?‚Äù \nüôä Convite opcional: ‚ÄúQuer receber diariamente uma Palavra de F√© em v√≠deo? √â gratuito. Responda: Quero minha dose di√°ria de f√©.‚Äù ",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        336,
        4304
      ],
      "id": "f43f2eae-91f2-49ab-8757-6eecb2ee4d53",
      "name": "CAMINHO 4.4",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Webhook').item.json.body.text }}",
                    "rightValue": "",
                    "operator": {
                      "type": "object",
                      "operation": "exists",
                      "singleValue": true
                    },
                    "id": "63adc694-5888-47cf-a09b-3c5d53e76eb2"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "texto"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e89b1c90-91c3-47e9-8854-0827a43f3ded",
                    "leftValue": "={{ $('Webhook').item.json.body.audio }}",
                    "rightValue": "",
                    "operator": {
                      "type": "object",
                      "operation": "exists",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "audio"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -464,
        4384
      ],
      "id": "46497c83-2b37-47ba-b4ee-6369af6130c5",
      "name": "[Propria]Tipo da resposta"
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 4,
            "attempts": 0,
            "sub_step": 5
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -16,
        4768
      ],
      "id": "79638347-c0e4-4846-b148-9765b05db2d3",
      "name": "Atualiza a subetapa:4.5",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 0,
            "sub_step": 0,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        576,
        4416
      ],
      "id": "b80e9d78-1287-4fc9-8c93-ea1ac2959b85",
      "name": "Volta pro menu inicial2",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_oracoes_personalizadas",
          "mode": "list",
          "cachedResultName": "whatsapp_oracoes_personalizadas"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "number": "={{ $json.phone_number }}",
            "tipo": "compartilhada",
            "nome_partilhada": "={{ $('Webhook').item.json.body.text.message }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "tipo",
              "displayName": "tipo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "nome_usuario",
              "displayName": "nome_usuario",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_partilhada",
              "displayName": "nome_partilhada",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "pedido",
              "displayName": "pedido",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "gerado",
              "displayName": "gerado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -496,
        4768
      ],
      "id": "15e0728c-fe1a-46ed-a5de-8e49f77602b0",
      "name": "[Compartilhada] Nome do presenteado",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_oracoes_personalizadas",
          "mode": "list",
          "cachedResultName": "whatsapp_oracoes_personalizadas"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "number": "={{ $json.phone_number }}",
            "nome_usuario": "={{ $('Webhook').item.json.body.text.message }}"
          },
          "matchingColumns": [
            "number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "tipo",
              "displayName": "tipo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_usuario",
              "displayName": "nome_usuario",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nome_partilhada",
              "displayName": "nome_partilhada",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "pedido",
              "displayName": "pedido",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "gerado",
              "displayName": "gerado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -496,
        4960
      ],
      "id": "d33ec476-28a1-4208-b6cf-b94a1128a31d",
      "name": "[Compartilhada] Nome de quem enviou",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "- Nome de quem est√° enviando",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -240,
        4768
      ],
      "id": "a16a6a2f-6021-4a06-9fd2-cc6ac83e248e",
      "name": "[Compartilhada] Solicita quem esta enviando",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "- Pedido de ora√ß√£o (texto ou √°udio)",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -240,
        4960
      ],
      "id": "97c1668a-9b32-40cd-881b-514eb4c31dbe",
      "name": "[Compartilhada] Solicita o pedido",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 4,
            "attempts": 0,
            "sub_step": 5
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -16,
        4960
      ],
      "id": "1faf0c01-7ba6-42d8-bc4f-725c68964bb4",
      "name": "Atualiza a subetapa:4.6",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Webhook').item.json.body.text }}",
                    "rightValue": "",
                    "operator": {
                      "type": "object",
                      "operation": "exists",
                      "singleValue": true
                    },
                    "id": "63adc694-5888-47cf-a09b-3c5d53e76eb2"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "texto"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e89b1c90-91c3-47e9-8854-0827a43f3ded",
                    "leftValue": "={{ $('Webhook').item.json.body.audio }}",
                    "rightValue": "",
                    "operator": {
                      "type": "object",
                      "operation": "exists",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "audio"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -528,
        5248
      ],
      "id": "83c28502-1387-4f58-b3b4-3171e63347e1",
      "name": "[Compartilhada]Tipo da resposta1"
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_oracoes_personalizadas",
          "mode": "list",
          "cachedResultName": "whatsapp_oracoes_personalizadas"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "number": "={{ $json.phone_number }}",
            "pedido": "={{ $('Webhook').item.json.body.text.message }}"
          },
          "matchingColumns": [
            "number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "tipo",
              "displayName": "tipo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_usuario",
              "displayName": "nome_usuario",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_partilhada",
              "displayName": "nome_partilhada",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "pedido",
              "displayName": "pedido",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "gerado",
              "displayName": "gerado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -240,
        5152
      ],
      "id": "5d9b4bab-8336-4851-8ae8-bd671dd688e6",
      "name": "Atualiza ora√ß√£o2",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -64,
        5280
      ],
      "id": "6d9a32f7-6816-432e-a098-739a9f8477b7",
      "name": "Transcribe a recording2",
      "credentials": {
        "openAiApi": {
          "id": "nrLX2LxKR5fSsuxx",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "url": "={{ $('Webhook').item.json.body.audio.audioUrl }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -240,
        5280
      ],
      "id": "a69bcd55-564a-47ee-8d46-caa72db57d77",
      "name": "Baixando audio2"
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "Ops! üôè\nPara fazer seu pedido, envie:\n- Um √°udio de 3 a 5 minutos üé§\nou\n-  Um texto de 300 a 600 palavras üí¨",
        "editMessageId": "=",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -240,
        5440
      ],
      "id": "a5be200f-0c64-47bf-bc08-5370d1a9c90c",
      "name": "FORMATO INVALIDO2",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_oracoes_personalizadas",
          "mode": "list",
          "cachedResultName": "whatsapp_oracoes_personalizadas"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "number": "={{ $json.phone_number }}",
            "pedido": "={{ $('Webhook').item.json.body.text.message }}"
          },
          "matchingColumns": [
            "number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "tipo",
              "displayName": "tipo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_usuario",
              "displayName": "nome_usuario",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_partilhada",
              "displayName": "nome_partilhada",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "pedido",
              "displayName": "pedido",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "gerado",
              "displayName": "gerado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        112,
        5280
      ],
      "id": "0deb9623-10b1-4978-b174-869654c6b713",
      "name": "Atualiza ora√ß√£o3",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "Falta muito pouco para voc√™ receber sua ora√ß√£o. Escolha agora o valor da sua doa√ß√£o, clique no link e finalize seu pedido.\n\nüí≥ Doa√ß√µes: \n- R$ 5,99 \n‚Äì Semente de f√© üå± \n- R$ 9,99 \n‚Äì Ora√ß√£o com prop√≥sito üïä \n- R$ 19,99 ‚Äì Milagre em forma de ora√ß√£o üí´ \n- Valor livre ‚Äî ‚ÄúMinha f√© ajuda outras pessoas‚Äù üíõ \n- Gr√°tis enquanto dispon√≠vel üìù \n\nBackup PIX: milagre@passe.com.br \nüé• Entrega: V√≠deo com voz do autor (Reginaldo Uller) Imagem simb√≥lica com legenda Vers√≠culo b√≠blico Trilha suave Legenda storytelling Dura√ß√£o: 100 a 150 segundos Formato: Shorts, Reels, WhatsApp, TikTok etc Qualidade e formato que atenda os aplicativos \n‚è∞ Ap√≥s 24h: ‚ÄúComo voc√™ est√° desde a √∫ltima vez que falamos? Posso orar por algo novo hoje?‚Äù \nüôä Convite opcional: ‚ÄúQuer receber diariamente uma Palavra de F√© em v√≠deo? √â gratuito. Responda: Quero minha dose di√°ria de f√©.‚Äù ",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        288,
        5152
      ],
      "id": "73c9a3f0-b37a-42b3-bda1-698128da0f09",
      "name": "CAMINHO 4.",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e24f43a5-cd32-4188-b9ed-334b66421fc3"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "1"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "bd28ed88-8810-48c1-849b-c3840bf83842",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "2"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "bb8f598a-5370-499d-8683-a52d813d36b0",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "3"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "bc938aa1-2527-4957-a069-5c11a6ea54d1",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "4"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -576,
        2544
      ],
      "id": "183b6abf-23c3-4abf-abe7-c6766b1e4f22",
      "name": "Escolha Valor"
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 0,
            "sub_step": 0,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        720,
        2672
      ],
      "id": "3d81a6bc-f437-40fc-8419-b19fcc650f05",
      "name": "Volta pro menu inicial3",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "content": "## ‚úÖ CAMINHO 3 ‚Äì PALAVRA DO DIA",
        "height": 1072,
        "width": 1632,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -800,
        2288
      ],
      "id": "7ebb885a-fd08-4fa3-9c8d-556994c7c539",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "url": "https://api.milagresreais.com.br/api/link-pagamento",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"valor\":5.99\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        2672
      ],
      "id": "81415bc0-a102-4f10-9766-02f9ece561d7",
      "name": "R$5,99"
    },
    {
      "parameters": {
        "url": "https://api.milagresreais.com.br/api/link-pagamento",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"valor\":9.99\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        2832
      ],
      "id": "d20ba14c-a7d4-458b-a97e-66ed1bf1d11c",
      "name": "R$9,99"
    },
    {
      "parameters": {
        "url": "https://api.milagresreais.com.br/api/link-pagamento",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"valor\":19.99\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        2992
      ],
      "id": "4a912c81-7715-4b10-8065-7433b73116b4",
      "name": "R$19,99"
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "={{ $json.response }}",
        "additionalFields": {
          "delayTyping": 5
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        256,
        2288
      ],
      "id": "0dc651dd-900e-4970-af93-90e1e17baaf6",
      "name": "Mensagem Gratuito",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 0,
            "sub_step": 0,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -1728,
        736
      ],
      "id": "079c4d1d-47b6-4de7-99a3-55b4fc0556cb",
      "name": "Volta pro menu inicial4",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "‚ú® Voc√™ pode se tornar um Anjo doando mensalmente a partir de R$1,99.\n\nüôè Escolha uma op√ß√£o:\n1Ô∏è‚É£ R$1,99 ‚Äì Semente leve  \n2Ô∏è‚É£ R$5,99 ‚Äì Pequeno Milagre  \n3Ô∏è‚É£ R$9,99 ‚Äì F√© ativa  \n4Ô∏è‚É£ R$19,99 ‚Äì Anjo de Esperan√ßa  \n5Ô∏è‚É£ R$49,99 ‚Äì Anjo Vision√°rio \n\nüíõ Para doar outro valor, utilize o Pix:\nüì© Chave Pix: milagresreaisoficial@gmail.com\n\nüòá Ser um Anjo √© ajudar o Milagres Reais a continuar alcan√ßando vidas todos os dias.\nSua semente mant√©m viva essa obra e faz parte do milagre na vida de muitas pessoas!\n",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -336,
        736
      ],
      "id": "5a1f50af-248c-42b6-9ab4-c609b634e955",
      "name": "CAMINHO 1 ‚Äì QUERO SER UM ANJO",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 3,
            "sub_step": 1,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -112,
        208
      ],
      "id": "4a4d8531-e861-4c4a-ab1e-025c782edfaf",
      "name": "Etapa:3",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 2,
            "sub_step": 1,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -112,
        16
      ],
      "id": "78aa6a5a-8ed5-400f-b29c-a5413833d356",
      "name": "Etapa:2",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "sub_step": 1,
            "attempts": 0,
            "current_step": 5
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -96,
        752
      ],
      "id": "64cd80eb-e09b-4719-b5bb-41d1b3d32e1c",
      "name": "Etapa:5",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 4,
            "sub_step": 1,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -112,
        400
      ],
      "id": "8d54174d-676c-453d-8f68-e7016797d9a0",
      "name": "Etapa:4",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 2,
            "sub_step": 2,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        64,
        1008
      ],
      "id": "cb79b778-561c-4e16-b6f8-429abeb5d7ca",
      "name": "Subetapa: 2",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 2,
            "sub_step": 3,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        640,
        1248
      ],
      "id": "f76bd339-f602-4be2-9500-b75780579fdb",
      "name": "Subetapa: 3",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "testemunhos",
          "mode": "list",
          "cachedResultName": "testemunhos"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "number": "={{ $('Webhook').item.json.body.phone }}",
            "depoimento": "={{ $json.text }}"
          },
          "matchingColumns": [
            "number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome",
              "displayName": "nome",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "depoimento",
              "displayName": "depoimento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        256,
        1376
      ],
      "id": "ed8f5430-54d5-427f-8341-bf8fa3f519e1",
      "name": "Atualiza o depoimento do testemunho",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        64,
        1376
      ],
      "id": "341c4152-19ca-4c78-b436-3cedae45e4c1",
      "name": "Transcrever depoimento",
      "credentials": {
        "openAiApi": {
          "id": "nrLX2LxKR5fSsuxx",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "‚ùå Op√ß√£o inv√°lida.\nPor favor, escolha um n√∫mero de 1 a 4.",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -272,
        3168
      ],
      "id": "d4c7fd05-e386-47aa-9fd8-15b0ad2de25a",
      "name": "ESCOLHA DE OP√á√ÉO INVALIDA",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "9d49a93d-ea81-4201-a64c-35c228d2bbb1",
              "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
              "rightValue": "VOLTAR PARA O MENU",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1968,
        960
      ],
      "id": "70f5b62e-9a7d-4deb-9369-1c55d79161e9",
      "name": "Verificar palavra chave \"VOLTAR PARA O MENU\""
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e24f43a5-cd32-4188-b9ed-334b66421fc3"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "1"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "bd28ed88-8810-48c1-849b-c3840bf83842",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "2"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "bb8f598a-5370-499d-8683-a52d813d36b0",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "3"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "bc938aa1-2527-4957-a069-5c11a6ea54d1",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "4"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "44237882-d859-46ea-9953-24e7c21b1cba",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "5",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "9873eb23-d5ce-4c53-8b5a-b58c41a661eb",
                    "leftValue": "={{ $('Webhook').item.json.body.text.message }}",
                    "rightValue": "6",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -688,
        6016
      ],
      "id": "69cb4fd7-29ef-41ad-bf67-131575a005e6",
      "name": "Escolha Valor1"
    },
    {
      "parameters": {
        "content": "## ‚úÖ ETAPA FINAL ‚Äì QUERO SER UM ANJO",
        "height": 1152,
        "width": 1632,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -800,
        5776
      ],
      "id": "b4bd796c-17ae-40cc-844c-da2500a08f9e",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "=Am√©m! üôè Segue o link para pagamento: \n\n{{ $json.link_pagamento }}\n\nQue o Senhor multiplique essa semente na sua vida üí´‚Äù",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        128,
        6208
      ],
      "id": "9894c995-1784-4565-b248-4af07e190e20",
      "name": "Mensagem Gratuito1",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "‚ùå Op√ß√£o inv√°lida.\nPor favor, escolha um n√∫mero de 1 a 6.",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -656,
        6496
      ],
      "id": "70610482-49d2-40b6-b063-7d800080ce8c",
      "name": "ESCOLHA DE OP√á√ÉO INVALIDA1",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "url": "https://api.milagresreais.com.br/api/link-pagamento",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"valor\":5.99\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        5872
      ],
      "id": "85cff86b-c241-4136-803b-3ed286be832a",
      "name": "1Ô∏è‚É£ R$1,99 ‚Äì Semente leve  "
    },
    {
      "parameters": {
        "url": "https://api.milagresreais.com.br/api/link-pagamento",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"valor\":5.99\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        6048
      ],
      "id": "14a45d2b-17f0-4aa9-b00e-c5bd4f075e17",
      "name": "2Ô∏è‚É£ R$3,99 ‚Äì Pequeno Milagre "
    },
    {
      "parameters": {
        "url": "https://api.milagresreais.com.br/api/link-pagamento",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"valor\":9.99\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        6208
      ],
      "id": "cd7e8848-2a6b-4b3b-91ea-e9fca29546f3",
      "name": "3Ô∏è‚É£ R$7,99 ‚Äì F√© ativa "
    },
    {
      "parameters": {
        "url": "https://api.milagresreais.com.br/api/link-pagamento",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"valor\":19.99\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        6368
      ],
      "id": "be6dc01c-9202-4f33-aa6a-2999a5eef58b",
      "name": "4Ô∏è‚É£ R$14,99 ‚Äì Apoio com prop√≥sito  "
    },
    {
      "parameters": {
        "url": "https://api.milagresreais.com.br/api/link-pagamento",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"valor\":19.99\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        6560
      ],
      "id": "595aca0f-3f9a-422f-9387-e98ea6f09cb9",
      "name": "5Ô∏è‚É£ R$29,99 ‚Äì Anjo de Esperan√ßa"
    },
    {
      "parameters": {
        "url": "https://api.milagresreais.com.br/api/link-pagamento",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"valor\":19.99\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        6736
      ],
      "id": "58f05ebf-f2cd-4cfa-a6af-21270cd1723a",
      "name": "6Ô∏è‚É£ R$49,99 ‚Äì Anjo Vision√°rio"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT COUNT(id)\nFROM public.palavras_do_dia w \nwhere w.number = '{{ $('Webhook').item.json.body.phone }}'\nand w.data = '{{$now.toFormat('yyyy-MM-dd')}}';",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -352,
        2336
      ],
      "id": "4fadf567-3874-46cf-a5ac-19e15fc8bdb3",
      "name": "Quantas palavras do dia foram geradas",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "={{ $json.response }}",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        64,
        2464
      ],
      "id": "a00d4b12-4943-4199-a1f0-4ee6fb47a9a2",
      "name": "Mensagem Gratuito2",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "029e0f97-3593-48ad-af41-b2f2681a3d28",
              "leftValue": "={{ $json.count }}",
              "rightValue": 3,
              "operator": {
                "type": "number",
                "operation": "lte"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {
          "ignoreCase": false
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -176,
        2336
      ],
      "id": "b2a6dea0-f5eb-43c0-bf44-6a779a833ed7",
      "name": "Olhar quantidade m√°xima gerada"
    },
    {
      "parameters": {
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "palavras_do_dia",
          "mode": "list",
          "cachedResultName": "palavras_do_dia"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "number": "={{ $('Webhook').item.json.body.phone }}",
            "palavra": "={{ $('Gerar uma mensagem da palavra do dia').item.json.response }}",
            "data": "={{$now.toFormat('yyyy-MM-dd')}}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "palavra",
              "displayName": "palavra",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "data",
              "displayName": "data",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        448,
        2288
      ],
      "id": "502c9089-14fa-472c-a39a-5dd79db699b6",
      "name": "Salvar prompt gerado da palavra",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "model": "openai/gpt-5-chat",
        "system_prompt": "PROMPT - Palavra do Dia - Envie diariamente uma mensagem √∫nica para fortalecer a f√©. Crie uma nova mensagem de at√© 120 palavras, diferente de todas as anteriores, com tom inspirador, emocional e acolhedor, como se fosse uma conversa √≠ntima com o ouvinte. Use met√°foras e exemplos variados para transmitir esperan√ßa, consolo e encorajamento. Inclua um vers√≠culo b√≠blico ao final da mensagem que sustente toda a frase. A mensagem deve fazer a pessoa sentir que foi escrita exatamente para ela hoje, refor√ßando que milagres s√£o reais e que Deus est√° presente em cada detalhe. N√£o repita frases ou constru√ß√µes j√° usadas anteriormente.\nMilagres reais √© o nome do projeto voce NAO DEVE INCLUIR ESSAS PALAVRAS DENTRO DA MENSAGEM GERADA\nA resposta deve vim sempre com o titulo: ‚ú® Palavra do Dia ‚Äì Milagres Reais ‚ú®\ntodo o versiculo e o indicador deve ester em italico\ne sua resposta final deve conter somente o titulo(em italico e negrito):\n‚ú® Palavra do Dia ‚Äì Milagres Reais ‚ú®\ne a palavra do dia.\nConsidere os seguintes temas para a palavra do dia para os respectivos dias:\nSegunda ‚Äì Motiva√ß√£o\nTer√ßa ‚Äì Cura\nQuarta ‚Äì Esperan√ßa\nQuinta ‚Äì Recome√ßos\nSexta ‚Äì Gratid√£o\nS√°bado ‚Äì Reflex√£o\nDomingo ‚Äì Familia\nFinalize todas as mensagens com o seguinte texto:\nQue Deus aben√ßoe e multiplique a sua semente de amor.\nüìå Voc√™ pode criar uma ora√ß√£o personalizada em √°udio, feita especialmente para voc√™ ou para algu√©m que voc√™ ama, acessando o menu na op√ß√£o 3.\n‚ú® Se sentir no cora√ß√£o, torne-se um Anjo do Projeto Milagres Reais pela op√ß√£o 4, e ajude a levar consolo e f√© a quem mais precisa.\nExemplo 1:\n‚ú® Palavra do Dia ‚Äì Milagres Reais ‚ú®\nHoje, guarde isto: voc√™ n√£o foi esquecido. Se o horizonte parece neblina, Deus acende um farol √† frente e cuida de cada pequeno detalhe. Ele deixa pistas de cuidado nas coisas simples ‚Äî um sorriso, uma pausa, uma porta que se abre. Milagre pode ser sil√™ncio que acalma ou resposta que chega. Caminhe leve; o Pai costura o que rasgou. Voc√™ √© amado agora. Respire: o c√©u trabalha a seu favor. ‚ÄúN√£o temas, porque eu sou contigo; n√£o te assombres, porque eu sou o teu Deus; eu te fortale√ßo, e te ajudo, e te sustento com a destra da minha justi√ßa.‚Äù (Isa√≠as 41:10)\nQue Deus aben√ßoe e multiplique a sua semente de amor.\nüìå Voc√™ pode criar uma ora√ß√£o personalizada em √°udio, feita especialmente para voc√™ ou para algu√©m que voc√™ ama, acessando o menu na op√ß√£o 3.\n‚ú® Se sentir no cora√ß√£o, torne-se um Anjo do Projeto Milagres Reais pela op√ß√£o 4, e ajude a levar consolo e f√© a quem mais precisa.\nExemplo 2:\n‚ú® Palavra do Dia ‚Äì Milagres Reais ‚ú®\nGuarde este sussurro: hoje, o C√©u te chamou pelo nome. Se o sono pesou nos ombros, Ele troca cinzas por brasa viva. Como jardineiro paciente, remove espinhos e rega o que parecia seco. H√° cuidado nos atrasos, prote√ß√£o nas curvas. Perceba os sinais: uma mensagem inesperada, um caf√© quentinho, uma lembran√ßa que aquece. Enquanto voc√™ respira, Deus organiza bastidores, alinhando encontros e sa√≠das. Pe√ßa luz; passos pequenos fazem caminho. Voc√™ n√£o est√° s√≥; teus passos t√™m compasso de amor. Deus cuida dos detalhes. E aquilo que parecia imposs√≠vel, florescer√°. Deus √© o nosso ref√∫gio e fortaleza, socorro bem presente na ang√∫stia. (Salmos 46:1)\nQue Deus aben√ßoe e multiplique a sua semente de amor.\nüìå Voc√™ pode criar uma ora√ß√£o personalizada em √°udio, feita especialmente para voc√™ ou para algu√©m que voc√™ ama, acessando o menu na op√ß√£o 3.\n‚ú® Se sentir no cora√ß√£o, torne-se um Anjo do Projeto Milagres Reais pela op√ß√£o 4, e ajude a levar consolo e f√© a quem mais precisa.\nExemplo 3:\n‚ú® Palavra do Dia ‚Äì Milagres Reais ‚ú®\nHoje, respire e perceba: h√° presentes discretos no seu caminho ‚Äî o caf√© que aquece, a mensagem na hora exata, a lembran√ßa que sorri por dentro. Gratid√£o √© chave que abre portas silenciosas; enquanto voc√™ agradece, o C√©u organiza os bastidores. Se algo parece pequeno, saiba: Deus borda grandeza nos detalhes. Ele est√° presente em cada detalhe. O imposs√≠vel se dobra ao toque do Pai; aquilo que ningu√©m explica acontece no tempo certo. Fique firme: o cuidado dEle √© agora, espec√≠fico, para voc√™. Sussurre ‚Äúobrigado‚Äù e caminhe leve; o peso perde for√ßa quando a alma louva. \"Em tudo, dai gra√ßas, porque esta √© a vontade de Deus em Cristo Jesus para convosco.\" (1 Tessalonicenses 5:18)\nQue Deus aben√ßoe e multiplique a sua semente de amor.\nüìå Voc√™ pode criar uma ora√ß√£o personalizada em √°udio, feita especialmente para voc√™ ou para algu√©m que voc√™ ama, acessando o menu na op√ß√£o 3.\n‚ú® Se sentir no cora√ß√£o, torne-se um Anjo do Projeto Milagres Reais pela op√ß√£o 4, e ajude a levar consolo e f√© a quem mais precisa.",
        "message": "me de a palavra do dia",
        "temperature": 0.5,
        "additionalFields": {}
      },
      "type": "n8n-nodes-openrouter.openRouter",
      "typeVersion": 1,
      "position": [
        64,
        2288
      ],
      "id": "2604ab7c-6cf5-4d06-8605-27d2711af34d",
      "name": "Gerar uma mensagem da palavra do dia",
      "credentials": {
        "openRouterApi": {
          "id": "XLUNvFV9dYDqE6Ci",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "üìâ Informar: |- Seu nome completo",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -208,
        3552
      ],
      "id": "57273dc6-8748-44f1-8069-c3f01fd894d1",
      "name": "[Propria] Definindo nome",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "üìâ Informar: \n- Nome completo do presenteado",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        -208,
        3712
      ],
      "id": "0da288f0-8898-43e5-83d5-e1f19db7f28c",
      "name": "[Compartilhada] Definindo nome presenteado",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "whatsapp_user_flows",
          "mode": "list",
          "cachedResultName": "whatsapp_user_flows"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Salva no banco de dados o numero').item.json.id }}",
            "current_step": 0,
            "sub_step": 0,
            "attempts": 0
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "flow_name",
              "displayName": "flow_name",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "phone_number",
              "displayName": "phone_number",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "current_step",
              "displayName": "current_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true
            },
            {
              "id": "sub_step",
              "displayName": "sub_step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "attempts",
              "displayName": "attempts",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "meta",
              "displayName": "meta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "object",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "last_interaction_at",
              "displayName": "last_interaction_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "updated_at",
              "displayName": "updated_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        304,
        6208
      ],
      "id": "decde074-a118-442a-97fc-e6dabebbf535",
      "name": "Volta pro menu inicial5",
      "credentials": {
        "postgres": {
          "id": "LqMDu8jySHRItDdq",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "phone": "={{ $('Webhook').item.json.body.phone }}",
        "text": "=Am√©m! üôè Segue o link para pagamento: \n\n{{ $json.link_pagamento }}\n\nQue o Senhor multiplique essa semente na sua vida üí´",
        "additionalFields": {
          "delayTyping": 3
        }
      },
      "type": "n8n-nodes-zapi.zapi",
      "typeVersion": 1,
      "position": [
        32,
        2848
      ],
      "id": "69b75ce3-a135-47b5-953e-5110d48dd456",
      "name": "Mensagem - Link de Pagamento",
      "credentials": {
        "zapiApi": {
          "id": "BOC3LsWBbq9QpnxD",
          "name": "Z-API account"
        }
      }
    }
  ],
  "pinData": {
    "Webhook": [
      {
        "json": {
          "headers": {
            "connection": "upgrade",
            "host": "n8n.milagresreais.com.br",
            "content-length": "728",
            "accept-encoding": "gzip, br",
            "content-type": "application/json",
            "origin": "https://api.z-api.io",
            "z-api-token": "6C7DC0E90939F58D36B138F9",
            "user-agent": "Mozilla/5.0 (iPad; CPU OS 16_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/111.0.5563.101 Mobile/15E148 Safari/604.1",
            "cf-ray": "97097cd4cb53d917-GRU",
            "server": "Z-API",
            "x-forwarded-for": "168.75.102.34",
            "cdn-loop": "cloudflare; loops=1",
            "cf-connecting-ip": "168.75.102.34",
            "cf-ipcountry": "BR",
            "cf-visitor": "{\"scheme\":\"https\"}",
            "x-forwarded-proto": "https"
          },
          "params": {},
          "query": {},
          "body": {
            "isStatusReply": false,
            "chatLid": "271076944785468@lid",
            "connectedPhone": "553199845498",
            "waitingMessage": false,
            "isEdit": false,
            "isGroup": false,
            "isNewsletter": false,
            "instanceId": "3E51386D6B07D10BA0A0E660A5CC20F3",
            "messageId": "3EB0A26AC41903131CDD90",
            "phone": "556293437083",
            "fromMe": false,
            "momment": 1755437023000,
            "status": "RECEIVED",
            "chatName": "BITVERSE",
            "senderPhoto": null,
            "senderName": "556293437083",
            "photo": "https://pps.whatsapp.net/v/t61.24694-24/473402985_988952399785859_2624761355492339342_n.jpg?ccb=11-4&oh=01_Q5Aa2QFAzIy9WqAhxicvxZdqspv4sZqar_Gj7G3r__YKPmfvCA&oe=68AEE0E3&_nc_sid=5e03e0&_nc_cat=102",
            "broadcast": false,
            "participantLid": null,
            "forwarded": false,
            "type": "ReceivedCallback",
            "fromApi": false,
            "text": {
              "message": "1"
            }
          },
          "webhookUrl": "https://n8n.milagresreais.com.br/webhook/2d913d19-cbbc-4762-b247-ce3342476e67",
          "executionMode": "production"
        }
      }
    ]
  },
  "repo_name": "milagres-reais-n8n",
  "repo_owner": "gabrielporfiro",
  "repo_path": "backup/",
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2025-07-22T20:33:18.683Z",
      "updatedAt": "2025-07-22T20:33:18.683Z",
      "id": "mlooW3lZymI5bPwP",
      "name": "whatsapp"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2025-08-21T03:43:19.611Z",
  "versionId": "9cc63e4c-0624-43a5-94cd-73a4446449b5"
}